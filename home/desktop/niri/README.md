# Niri æ¡Œé¢ç¯å¢ƒé…ç½®

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Niri æ¡Œé¢ç¯å¢ƒé…ç½®ï¼Œä¸“ä¸º NixOS ç³»ç»Ÿè®¾è®¡ï¼Œé‡‡ç”¨æ¨¡å—åŒ–ç»“æ„ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸš€ æ ¸å¿ƒåŠŸèƒ½
- **æ»šåŠ¨å¹³é“ºçª—å£ç®¡ç†**: Niri ç‹¬ç‰¹çš„æ— é™æ°´å¹³æ»šåŠ¨å¸ƒå±€
- **ç°ä»£åŠ¨ç”»æ•ˆæœ**: æµç•…çš„çª—å£åˆ‡æ¢å’Œå·¥ä½œåŒºåŠ¨ç”»
- **å®Œæ•´çš„ Wayland æ”¯æŒ**: åŸç”Ÿ Wayland åº”ç”¨ä½“éªŒ
- **å¤šæ˜¾ç¤ºå™¨æ”¯æŒ**: æ¯ä¸ªæ˜¾ç¤ºå™¨ç‹¬ç«‹çš„å·¥ä½œåŒº

### ğŸ¨ è§†è§‰æ•ˆæœ
- **æ¸å˜è¾¹æ¡†**: æ´»åŠ¨çª—å£çš„ç‚«é…·æ¸å˜è¾¹æ¡†æ•ˆæœ
- **èšç„¦ç¯**: æ¸…æ™°çš„çª—å£èšç„¦æŒ‡ç¤º
- **è‡ªå®šä¹‰é¢œè‰²ä¸»é¢˜**: åŸºäºç´«è‰²è°ƒçš„ç°ä»£é…è‰²
- **å“åº”å¼å¸ƒå±€**: æ”¯æŒä¸åŒåˆ†è¾¨ç‡çš„æ˜¾ç¤ºå™¨

### âš™ï¸ é›†æˆç»„ä»¶
- **Waybar**: åŠŸèƒ½ä¸°å¯Œçš„çŠ¶æ€æ ï¼Œæ”¯æŒ Niri å·¥ä½œåŒº
- **Fuzzel**: ç°ä»£åŒ–çš„åº”ç”¨å¯åŠ¨å™¨
- **Dunst**: ç¾è§‚çš„é€šçŸ¥ç³»ç»Ÿ
- **Swaylock**: å®‰å…¨çš„å±å¹•é”å®š
- **XWayland-satellite**: X11 åº”ç”¨å…¼å®¹å±‚

## å®‰è£…å’Œä½¿ç”¨

### 1. å¯ç”¨é…ç½®

åœ¨ä½ çš„ NixOS é…ç½®ä¸­å¯ç”¨ Niri:

```nix
# ç³»ç»Ÿé…ç½®
mySystem.desktop = {
  enable = true;
  preset = "niri";
};

# Home Manager é…ç½®
myHome.desktop = {
  enable = true;
  niri = {
    enable = true;
    method = "external";
  };
};
```

### 2. é‡å»ºç³»ç»Ÿ

```bash
sudo nixos-rebuild switch
home-manager switch
```

### 3. å¯åŠ¨ Niri

ä» GDM ç™»å½•ç•Œé¢é€‰æ‹© "Niri" ä¼šè¯ï¼Œæˆ–è€…åœ¨ TTY ä¸­è¿è¡Œï¼š

```bash
niri-session
```

## å¿«æ·é”®æŒ‡å—

### ğŸš€ åº”ç”¨å¯åŠ¨
- `Super + T`: å¯åŠ¨ç»ˆç«¯ (Alacritty)
- `Super + D`: åº”ç”¨å¯åŠ¨å™¨ (Fuzzel)
- `Super + E`: æ–‡ä»¶ç®¡ç†å™¨ (Nautilus)
- `Super + B`: æµè§ˆå™¨ (Firefox)
- `Super + C`: ä»£ç ç¼–è¾‘å™¨ (VSCode)

### ğŸªŸ çª—å£ç®¡ç†
- `Super + Q`: å…³é—­çª—å£
- `Super + H/L` æˆ– `Super + â†/â†’`: å·¦å³åˆ‡æ¢åˆ—
- `Super + J/K` æˆ– `Super + â†‘/â†“`: ä¸Šä¸‹åˆ‡æ¢çª—å£
- `Super + Ctrl + H/L`: ç§»åŠ¨åˆ—
- `Super + Ctrl + J/K`: ç§»åŠ¨çª—å£

### ğŸ“± å·¥ä½œåŒºæ“ä½œ
- `Super + U/I` æˆ– `Super + PageDown/PageUp`: åˆ‡æ¢å·¥ä½œåŒº
- `Super + 1-0`: åˆ‡æ¢åˆ°æ•°å­—å·¥ä½œåŒº
- `Super + Ctrl + 1-0`: ç§»åŠ¨çª—å£åˆ°æ•°å­—å·¥ä½œåŒº
- `Super + Tab`: æ¦‚è§ˆæ¨¡å¼

### ğŸ›ï¸ çª—å£è°ƒæ•´
- `Super + R`: åˆ‡æ¢é¢„è®¾åˆ—å®½
- `Super + Shift + R`: åˆ‡æ¢é¢„è®¾çª—å£é«˜åº¦
- `Super + F`: æœ€å¤§åŒ–åˆ—
- `Super + Shift + F`: å…¨å±çª—å£
- `Super + -/=`: è°ƒæ•´åˆ—å®½
- `Super + Shift + -/=`: è°ƒæ•´çª—å£é«˜åº¦

### ğŸ”„ åˆ—æ“ä½œ
- `Super + ,`: åˆå¹¶å³ä¾§çª—å£åˆ°å½“å‰åˆ—
- `Super + .`: åˆ†ç¦»åˆ—åº•éƒ¨çª—å£
- `Super + [/]`: å·¦å³åˆå¹¶/åˆ†ç¦»çª—å£

### ğŸ¨ ç‰¹æ®ŠåŠŸèƒ½
- `Super + V`: åˆ‡æ¢æµ®åŠ¨çª—å£
- `Super + Shift + V`: åˆ‡æ¢æµ®åŠ¨/å¹³é“ºå¸ƒå±€ç„¦ç‚¹
- `Super + Alt + L`: é”å±
- `Super + Shift + E`: é€€å‡º Niri

### ğŸ“¸ æˆªå›¾å’Œåª’ä½“
- `Print`: åŒºåŸŸæˆªå›¾
- `Alt + Print`: çª—å£æˆªå›¾
- `Ctrl + Print`: å…¨å±æˆªå›¾
- `Shift + Print`: åŒºåŸŸæˆªå›¾åˆ°å‰ªè´´æ¿
- `éŸ³é‡é”®`: éŸ³é‡æ§åˆ¶
- `äº®åº¦é”®`: äº®åº¦è°ƒèŠ‚

## é…ç½®æ–‡ä»¶ç»“æ„

```
home/desktop/niri/external/
â”œâ”€â”€ niri/
â”‚   â””â”€â”€ config.kdl              # Niri ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ waybar/
â”‚   â”œâ”€â”€ config                  # Waybar é…ç½®
â”‚   â””â”€â”€ style.css              # Waybar æ ·å¼
â”œâ”€â”€ fuzzel/
â”‚   â””â”€â”€ fuzzel.ini             # Fuzzel å¯åŠ¨å™¨é…ç½®
â”œâ”€â”€ dunst/
â”‚   â””â”€â”€ dunstrc                # Dunst é€šçŸ¥é…ç½®
â”œâ”€â”€ swaylock/
â”‚   â””â”€â”€ config                 # Swaylock é”å±é…ç½®
â””â”€â”€ scripts/
    â”œâ”€â”€ screenshot.sh          # æˆªå›¾è„šæœ¬
    â”œâ”€â”€ volume.sh             # éŸ³é‡æ§åˆ¶è„šæœ¬
    â”œâ”€â”€ brightness.sh         # äº®åº¦æ§åˆ¶è„šæœ¬
    â””â”€â”€ toggle-display.sh     # æ˜¾ç¤ºå™¨åˆ‡æ¢è„šæœ¬
```

## è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹ä¸»é¢˜é¢œè‰²

ç¼–è¾‘ `niri/config.kdl` ä¸­çš„é¢œè‰²è®¾ç½®ï¼š

```kdl
border {
    active-color "#ä½ çš„é¢œè‰²"
    active-gradient from="#èµ·å§‹è‰²" to="#ç»“æŸè‰²" angle=45
}
```

### è°ƒæ•´å·¥ä½œåŒº

ä¿®æ”¹ `waybar/config` ä¸­çš„å·¥ä½œåŒºè®¾ç½®ï¼š

```json
"persistent-workspaces": {
    "1": [],
    "2": [],
    "3": [],
    "4": [],
    "5": []
}
```

### è‡ªå®šä¹‰å¿«æ·é”®

åœ¨ `niri/config.kdl` çš„ `binds` éƒ¨åˆ†æ·»åŠ æˆ–ä¿®æ”¹å¿«æ·é”®ï¼š

```kdl
"Mod+ä½ çš„æŒ‰é”®" { spawn "ä½ çš„å‘½ä»¤"; }
```

## æ•…éšœæ’é™¤

### é»‘å±é—®é¢˜
å¦‚æœå¯åŠ¨ Niri åå‡ºç°é»‘å±ï¼Œå°è¯•ï¼š
1. æ£€æŸ¥æ˜¾å¡é©±åŠ¨æ˜¯å¦æ­£ç¡®å®‰è£…
2. ç¡®è®¤å†…æ ¸æ¨¡å¼è®¾ç½®å·²å¯ç”¨
3. æŸ¥çœ‹ `journalctl -u display-manager` æ—¥å¿—

### X11 åº”ç”¨é—®é¢˜
å¦‚æœ X11 åº”ç”¨æ— æ³•è¿è¡Œï¼š
1. ç¡®è®¤ `xwayland-satellite` æœåŠ¡æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç¯å¢ƒå˜é‡è®¾ç½®æ˜¯å¦æ­£ç¡®

### æ€§èƒ½é—®é¢˜
å¦‚æœé‡åˆ°æ€§èƒ½é—®é¢˜ï¼š
1. ç¦ç”¨åŠ¨ç”»ï¼šåœ¨ `config.kdl` ä¸­è®¾ç½® `animations { off true }`
2. è°ƒæ•´æ¸²æŸ“è®¾å¤‡ï¼šä¿®æ”¹ `debug` éƒ¨åˆ†çš„ `render-drm-device`

## å‚è€ƒèµ„æº

- [Niri å®˜æ–¹æ–‡æ¡£](https://github.com/YaLTeR/niri/wiki)
- [Niri é…ç½®å‚è€ƒ](https://github.com/YaLTeR/niri/wiki/Configuration:-Introduction)
- [Waybar æ¨¡å—æ–‡æ¡£](https://github.com/Alexays/Waybar/wiki/Module:-Niri)
- [NixOS Wayland æŒ‡å—](https://nixos.wiki/wiki/Wayland)

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›è¿™ä¸ªé…ç½®ï¼
