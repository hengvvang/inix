# ========================================
# macOS Tahoe 流体玻璃主题配置
# ========================================

# macOS Tahoe 风格颜色定义 - 蓝色透明玻璃主题
$glass_blue = 0x4d007AFF      # 半透明蓝色
$glass_white = 0x33FFFFFF     # 半透明白色
$glass_gray = 0x4d8E8E93      # 半透明灰色
$glass_dark = 0x66000000      # 半透明黑色
$accent_blue = 0xff007AFF     # 系统蓝色
$accent_purple = 0xffAF52DE   # 系统紫色
$text_primary = 0xffFFFFFF    # 主文本颜色
$text_secondary = 0xcc8E8E93  # 次要文本颜色
$background_glass = 0x1a1a1a1a # 极其透明的背景
$border_glass = 0x66FFFFFF    # 玻璃边框
$shadow_color = 0x80000000    # 阴影颜色

# ========================================
# 通用设置 - macOS 风格
# ========================================
general {
    # 边框设置
    border_size = 1
    no_border_on_floating = false
    
    # 间距设置 - 类似 macOS 的紧凑布局
    gaps_in = 8
    gaps_out = 16
    float_gaps = 8
    gaps_workspaces = 0
    
    # 边框颜色 - 玻璃效果
    col.active_border = $border_glass $accent_blue 45deg
    col.inactive_border = $glass_gray
    col.nogroup_border = $glass_gray
    col.nogroup_border_active = $accent_purple
    
    # 布局
    layout = dwindle
    
    # 调整大小和拖拽
    resize_on_border = true
    extend_border_grab_area = 10
    hover_icon_on_border = true
}

# ========================================
# 装饰设置 - 玻璃效果核心
# ========================================
decoration {
    # 圆角 - macOS 风格
    rounding = 12
    rounding_power = 2.5
    
    # 透明度设置 - 玻璃效果关键
    active_opacity = 0.95
    inactive_opacity = 0.85
    fullscreen_opacity = 1.0
    
    # 窗口变暗效果
    dim_inactive = true
    dim_strength = 0.15
    dim_special = 0.3
    dim_around = 0.4
    
    # 模糊设置 - 流体玻璃效果的核心
    blur {
        enabled = true
        size = 16
        passes = 3
        ignore_opacity = false
        new_optimizations = true
        xray = true
        
        # 玻璃效果调优
        noise = 0.02
        contrast = 1.1
        brightness = 1.2
        vibrancy = 0.3
        vibrancy_darkness = 0.1
        
        # 特殊区域模糊
        special = true
        popups = true
        popups_ignorealpha = 0.1
        input_methods = true
        input_methods_ignorealpha = 0.1
    }
    
    # 阴影设置 - macOS 风格深度
    shadow {
        enabled = true
        range = 20
        render_power = 3
        sharp = false
        ignore_window = false
        color = $shadow_color
        color_inactive = 0x60000000
        offset = [0, 8]
        scale = 1.0
    }
}

# ========================================
# 动画设置 - 流体感觉
# ========================================
animations {
    enabled = true
    first_launch_animation = true
    
    # 平滑的动画曲线 - 类似 macOS
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    bezier = linear, 0.0, 0.0, 1.0, 1.0
    bezier = wind, 0.05, 0.9, 0.1, 1.05
    bezier = winIn, 0.1, 1.1, 0.1, 1.1
    bezier = winOut, 0.3, -0.3, 0, 1
    bezier = slow, 0, 0.85, 0.3, 1
    
    # 窗口动画
    animation = windows, 1, 6, wind, slide
    animation = windowsIn, 1, 6, winIn, slide
    animation = windowsOut, 1, 5, winOut, slide
    animation = windowsMove, 1, 5, wind, slide
    
    # 淡入淡出
    animation = fade, 1, 10, myBezier
    animation = fadeIn, 1, 10, myBezier
    animation = fadeOut, 1, 7, myBezier
    animation = fadeSwitch, 1, 8, myBezier
    animation = fadeShadow, 1, 8, myBezier
    animation = fadeDim, 1, 8, myBezier
    
    # 边框动画
    animation = border, 1, 20, linear
    animation = borderangle, 1, 100, linear, loop
    
    # 工作区动画
    animation = workspaces, 1, 6, myBezier, slide
    animation = specialWorkspace, 1, 6, myBezier, slidevert
}

# ========================================
# 输入设置 - macOS 风格
# ========================================
input {
    kb_layout = us
    
    # 鼠标设置
    follow_mouse = 1
    float_switch_override_focus = 2
    mouse_refocus = true
    
    # 触摸板设置 - macOS 风格
    touchpad {
        natural_scroll = true
        scroll_factor = 1.0
        middle_button_emulation = false
        tap-to-click = true
        tap-and-drag = true
        drag_lock = false
        disable_while_typing = true
    }
    
    sensitivity = 0.0
}

# ========================================
# 手势设置 - macOS 风格导航
# ========================================
gestures {
    workspace_swipe = true
    workspace_swipe_fingers = 3
    workspace_swipe_distance = 300
    workspace_swipe_invert = true
    workspace_swipe_min_speed_to_force = 30
    workspace_swipe_cancel_ratio = 0.5
    workspace_swipe_create_new = true
    workspace_swipe_direction_lock = true
    workspace_swipe_direction_lock_threshold = 10
    workspace_swipe_forever = false
}

# ========================================
# 组设置 - 标签式窗口管理
# ========================================
group {
    auto_group = false
    insert_after_current = true
    focus_removed_window = true
    
    # 组边框颜色
    col.border_active = $accent_blue
    col.border_inactive = $glass_gray
    col.border_locked_active = $accent_purple
    col.border_locked_inactive = $glass_dark
    
    groupbar {
        enabled = true
        font_size = 11
        gradients = true
        height = 16
        priority = 3
        render_titles = true
        scrolling = true
        
        # 组栏颜色 - 玻璃效果
        col.active = $glass_blue
        col.inactive = $glass_gray
        col.locked_active = $accent_purple
        col.locked_inactive = $glass_dark
        
        text_color = $text_primary
        text_color_inactive = $text_secondary
    }
}

# ========================================
# 杂项设置
# ========================================
misc {
    disable_hyprland_logo = false
    disable_splash_rendering = false
    force_default_wallpaper = -1
    vfr = true
    vrr = 0
    
    # 鼠标和键盘
    mouse_move_enables_dpms = false
    key_press_enables_dpms = false
    always_follow_on_dnd = true
    
    # 动画设置
    animate_manual_resizes = true
    animate_mouse_windowdragging = true
    
    # 焦点设置
    focus_on_activate = false
    mouse_move_focuses_monitor = true
    
    # 背景色 - 深色玻璃
    background_color = 0xff1a1a1a
    
    # 新窗口行为
    new_window_takes_over_fullscreen = 0
    initial_workspace_tracking = 1
}

# ========================================
# 绑定设置
# ========================================
binds {
    pass_mouse_when_bound = false
    scroll_event_delay = 300
    workspace_back_and_forth = false
    allow_workspace_cycles = false
    workspace_center_on = 0
    focus_preferred_method = 0
    ignore_group_lock = false
    movefocus_cycles_fullscreen = true
}

# ========================================
# 渲染设置 - 玻璃效果优化
# ========================================
render {
    direct_scanout = false
    expand_undersized_textures = true
    xp_mode = false
}

# ========================================
# 光标设置
# ========================================
cursor {
    no_hardware_cursors = false
    no_break_fs_vrr = false
    min_refresh_rate = 24
    hotspot_padding = 1
    inactive_timeout = 0
    no_warps = false
    persistent_warps = false
    warp_on_change_workspace = false
}

# ========================================
# 窗口规则 - 增强玻璃效果
# ========================================

# 浮动窗口特殊效果
windowrulev2 = opacity 0.9 0.8, floating:1
windowrulev2 = rounding 16, floating:1
windowrulev2 = bordercolor $accent_blue, floating:1

# 系统对话框
windowrulev2 = opacity 0.95 0.9, class:^(polkit).*$
windowrulev2 = opacity 0.95 0.9, class:^(gcr-prompter)$

# 通知
windowrulev2 = opacity 0.9 0.85, class:^(dunst)$
windowrulev2 = rounding 12, class:^(dunst)$

# 终端应用 - 更强的玻璃效果
windowrulev2 = opacity 0.85 0.75, class:^(kitty)$
windowrulev2 = opacity 0.85 0.75, class:^(alacritty)$
windowrulev2 = opacity 0.85 0.75, class:^(foot)$

# 文件管理器
windowrulev2 = opacity 0.9 0.85, class:^(thunar)$
windowrulev2 = opacity 0.9 0.85, class:^(nautilus)$
windowrulev2 = opacity 0.9 0.85, class:^(dolphin)$

# 应用启动器和菜单
windowrulev2 = opacity 0.85 0.8, class:^(rofi)$
windowrulev2 = opacity 0.85 0.8, class:^(wofi)$
windowrulev2 = rounding 16, class:^(rofi)$
windowrulev2 = rounding 16, class:^(wofi)$

# VSCode - 轻微透明
windowrulev2 = opacity 0.95 0.9, class:^(code)$

# 浏览器 - 保持清晰
windowrulev2 = opacity 1.0 0.95, class:^(firefox)$
windowrulev2 = opacity 1.0 0.95, class:^(chromium)$

# 媒体播放器
windowrulev2 = opacity 0.9 0.85, class:^(mpv)$
windowrulev2 = opacity 0.9 0.85, class:^(vlc)$

# ========================================
# 层规则 - 玻璃效果扩展
# ========================================

# 状态栏和面板
layerrule = blur, ironbar
layerrule = ignorealpha 0.2, ironbar
# 状态栏和面板
# layerrule = blur, waybar
# layerrule = ignorealpha 0.2, waybar

# 启动器
layerrule = blur, rofi
layerrule = ignorealpha 0.2, rofi

# 通知
layerrule = blur, notifications
layerrule = ignorealpha 0.2, notifications

# 锁屏
layerrule = blur, lockscreen
layerrule = ignorealpha 0.2, lockscreen

# ========================================
# 环境变量 - 玻璃效果优化
# ========================================

# 启用硬件加速
env = WLR_NO_HARDWARE_CURSORS,1
env = XCURSOR_SIZE,24

# Qt 优化
env = QT_QPA_PLATFORM,wayland
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1

# 启用透明度
env = HYPRLAND_INSTANCE_SIGNATURE,glass_mode
