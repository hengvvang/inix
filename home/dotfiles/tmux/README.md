# Tmux Home Manager 配置说明

## 配置概览

这个 tmux 配置使用 Home Manager 的 `programs.tmux` 模块，提供了完整的 tmux 会话管理功能。

## 主要配置选项

### 基础设置

| 选项 | 值 | 说明 |
|------|----|----- |
| `enable` | `true` | 启用 tmux 程序 |
| `shell` | `fish` | 设置默认 shell 为 fish |
| `terminal` | `tmux-256color` | 终端类型，支持 256 色和真彩色 |
| `baseIndex` | `1` | 窗口编号从 1 开始（而不是 0） |
| `keyMode` | `vi` | 使用 Vi 键位模式进行导航 |
| `prefix` | `C-a` | 前缀键设为 Ctrl+a（替代默认的 Ctrl+b） |
| `mouse` | `true` | 启用鼠标支持，可以用鼠标选择面板和调整大小 |
| `historyLimit` | `100000` | 增加历史记录缓冲区大小 |
| `escapeTime` | `0` | 减少按键转义延迟，提升响应速度 |

### 核心功能

#### 1. 窗口和面板管理
- **分割窗口**: `|` 垂直分割，`-` 水平分割
- **面板导航**: `h/j/k/l` Vi 风格导航
- **面板调整**: `H/J/K/L` 调整面板大小
- **窗口切换**: `Alt+h/l` 切换上一个/下一个窗口
- **快速选择**: `Alt+1-5` 快速选择窗口

#### 2. 复制模式
- **进入选择**: `v` 开始选择文本
- **复制**: `y` 或 `Enter` 复制选中文本到剪贴板
- **剪贴板**: 使用 `wl-copy` 支持 Wayland 剪贴板

#### 3. 会话管理
- **重载配置**: `prefix + r` 重新加载配置
- **选择会话**: `prefix + Ctrl-s` 选择会话
- **选择窗口**: `prefix + Ctrl-w` 选择窗口
- **面板最大化**: `prefix + m` 最大化/恢复面板
- **面板同步**: `prefix + S` 同步面板输入

### 外观主题

使用了类似 Tokyo Night 的配色方案：

#### 颜色定义
- **背景色**: `#1a1b26` (深蓝黑色)
- **前景色**: `#c0caf5` (浅蓝白色)
- **活动色**: `#7aa2f7` (蓝色)
- **成功色**: `#9ece6a` (绿色)
- **警告色**: `#f7768e` (红色)

#### 状态栏布局
- **左侧**: 会话名称，绿色背景
- **右侧**: 日期时间和主机名
- **窗口状态**: 当前窗口蓝色高亮，其他窗口灰色

### 监控和自动化

- **活动监控**: 监控窗口活动但不显示视觉提示
- **自动重命名**: 根据当前运行的程序自动重命名窗口
- **标题设置**: 设置终端标题为当前程序名

### 插件支持

配置支持 tmux 插件，常用插件（已注释）：

- `sensible`: 提供合理的默认设置
- `resurrect`: 会话保存和恢复
- `continuum`: 自动保存会话
- `yank`: 改进的复制功能
- `prefix-highlight`: 前缀键状态高亮

## 使用建议

### 启用插件
如果需要某个插件，取消相应行的注释：

```nix
plugins = with pkgs.tmuxPlugins; [
  sensible          # 取消注释启用
  resurrect         # 取消注释启用
  # ...
];
```

### 自定义配置
如果需要添加更多配置，在 `extraConfig` 部分添加：

```nix
extraConfig = ''
  # 现有配置...
  
  # 你的自定义配置
  bind-key x kill-pane
'';
```

### 键绑定总结

| 键绑定 | 功能 |
|--------|------|
| `Ctrl-a` | 前缀键 |
| `prefix + \|` | 垂直分割 |
| `prefix + -` | 水平分割 |
| `prefix + h/j/k/l` | 面板导航 |
| `prefix + H/J/K/L` | 面板调整 |
| `Alt + h/l` | 窗口切换 |
| `Alt + 1-5` | 快速窗口选择 |
| `prefix + r` | 重载配置 |
| `prefix + m` | 面板最大化 |

## 性能优化

- 设置 `escapeTime = 0` 减少延迟
- 增加 `historyLimit` 到 100000
- 启用 `focus-events` 改善编辑器集成
- 优化状态栏更新间隔为 1 秒

这个配置平衡了功能性、性能和美观，适合日常开发使用。
