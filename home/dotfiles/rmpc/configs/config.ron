#![enable(implicit_some)]
#![enable(unwrap_newtypes)]
#![enable(unwrap_variant_newtypes)]
(
    // ==================== MPD 连接配置 ====================
    address: "127.0.0.1:6600",                  // MPD 服务器地址和端口
    password: None,                              // 本地连接无需密码
    
    // ==================== 存储目录配置 ====================
    cache_dir: "${config.home.homeDirectory}/.cache/rmpc",               // 缓存目录 - 存储临时数据和封面缓存
    lyrics_dir: "${config.home.homeDirectory}/.local/share/rmpc/lyrics",    // 歌词目录 - 存储下载的歌词文件

    // ==================== 外观主题配置 ====================
    theme: None,                                 // 使用默认主题（跟随终端配色）
    
    // ==================== 性能优化配置 ====================
    max_fps: 30,                                 // 最大刷新率30fps，平衡性能与体验
    scrolloff: 3,                                // 滚动偏移3行，类似vim的scrolloff
    wrap_navigation: true,                       // 启用导航循环
    enable_mouse: true,                          // 启用鼠标支持
    enable_config_hot_reload: true,              // 启用配置热重载
    
    // ==================== 播放控制配置 ====================
    volume_step: 5,                              // 音量调节步长5%
    rewind_to_start_sec: 3,                      // 快退到开头的时间阈值3秒
    status_update_interval_ms: 500,              // 状态更新间隔500毫秒
    select_current_song_on_change: true,         // 歌曲切换时自动选中
    center_current_song_on_change: true,         // 歌曲切换时居中显示
    
    // ==================== 网络超时配置 ====================
    mpd_read_timeout_ms: 10000,                  // MPD读取超时10秒
    mpd_write_timeout_ms: 5000,                  // MPD写入超时5秒
    mpd_idle_read_timeout_ms: None,              // 空闲连接无超时限制
    
    // ==================== 播放列表管理 ====================
    reflect_changes_to_playlist: false,          // 禁用自动同步到播放列表，避免意外修改
    
    // ==================== 专辑封面配置 ====================
    album_art: (
        method: Auto,                            // 自动检测封面来源
        max_size_px: (width: 800, height: 800), // 最大封面尺寸800x800
        disabled_protocols: ["http://", "https://"], // 禁用网络协议，仅本地封面
        vertical_align: Center,                  // 垂直居中对齐
        horizontal_align: Center,                // 水平居中对齐
    ),
    
    // ==================== 桌面通知配置 ====================
    on_song_change: [
        "notify-send", 
        "--expire-time=3000",                    // 通知显示时间3秒
        "--icon=audio-x-generic", 
        "♪ 正在播放", 
        "{artist} - {title}"                     // 通知格式：艺术家 - 标题
    ],
    
    // ==================== 搜索功能配置 ====================
    search: (
        case_sensitive: false,                   // 搜索不区分大小写
        mode: Contains,                          // 包含模式搜索
        // 搜索标签定义（支持中文标签）
        tags: [
            (value: "any", label: "任意标签"),
            (value: "artist", label: "艺术家"),
            (value: "album", label: "专辑"),
            (value: "albumartist", label: "专辑艺术家"),
            (value: "title", label: "标题"),
            (value: "filename", label: "文件名"),
            (value: "genre", label: "流派"),
            (value: "date", label: "日期"),
        ],
    ),
    
    // ==================== 艺术家视图配置 ====================
    artists: (
        album_display_mode: SplitByDate,         // 按日期分割专辑显示
        album_sort_by: Date,                     // 专辑按日期排序
    ),
    
    // ==================== 排序配置 ====================
    browser_song_sort: [Disc, Track, Artist, Title], // 浏览器歌曲排序优先级
    directories_sort: SortFormat(group_by_type: true, reverse: false), // 目录排序：按类型分组
    show_playlists_in_browser: NonRoot,          // 仅在非根目录显示播放列表
    
    // ==================== 键位绑定配置 ====================
    keybinds: (
        // ===== 全局键位绑定 =====
        global: {
            // --- 命令和音量控制 ---
            ":": CommandMode,                    // 进入命令模式（vim风格）
            ",": VolumeDown,                     // 音量减
            ".": VolumeUp,                       // 音量加
            
            // --- 播放控制 ---
            "s": Stop,                           // 停止播放
            "p": TogglePause,                    // 播放/暂停切换
            ">": NextTrack,                      // 下一首
            "<": PreviousTrack,                  // 上一首
            "f": SeekForward,                    // 快进
            "b": SeekBack,                       // 快退
            
            // --- 播放模式切换 ---
            "z": ToggleRepeat,                   // 切换重复播放
            "x": ToggleRandom,                   // 切换随机播放
            "c": ToggleConsume,                  // 切换消费模式
            "v": ToggleSingle,                   // 切换单曲模式
            
            // --- 应用控制 ---
            "q": Quit,                           // 退出程序
            "?": ShowHelp,                       // 显示帮助
            
            // --- MPD数据库操作 ---
            "u": Update,                         // 更新音乐库
            "U": Rescan,                         // 完全重新扫描音乐库
            "R": AddRandom,                      // 添加随机歌曲到队列
            
            // --- 信息显示 ---
            "I": ShowCurrentSongInfo,            // 显示当前歌曲信息
            "O": ShowOutputs,                    // 显示音频输出设备
            "P": ShowDecoders,                   // 显示解码器信息
            
            // --- 标签页控制 ---
            "<Tab>": NextTab,                    // 下一个标签页
            "<S-Tab>": PreviousTab,              // 上一个标签页
            "1": SwitchToTab("Queue"),           // 切换到播放队列
            "2": SwitchToTab("Directories"),     // 切换到目录浏览
            "3": SwitchToTab("Artists"),         // 切换到艺术家
            "4": SwitchToTab("Album Artists"),   // 切换到专辑艺术家
            "5": SwitchToTab("Albums"),          // 切换到专辑
            "6": SwitchToTab("Playlists"),       // 切换到播放列表
            "7": SwitchToTab("Search"),          // 切换到搜索
        },
        
        // ===== 导航键位绑定 =====
        navigation: {
            // --- Vim风格导航 ---
            "k": Up,                             // 上移（vim风格）
            "j": Down,                           // 下移（vim风格）
            "h": Left,                           // 左移（vim风格）
            "l": Right,                          // 右移（vim风格）
            
            // --- 传统方向键 ---
            "<Up>": Up,
            "<Down>": Down,
            "<Left>": Left,
            "<Right>": Right,
            
            // --- 面板间导航 ---
            "<C-k>": PaneUp,                     // 上一个面板
            "<C-j>": PaneDown,                   // 下一个面板
            "<C-h>": PaneLeft,                   // 左侧面板
            "<C-l>": PaneRight,                  // 右侧面板
            
            // --- 页面滚动 ---
            "<C-u>": UpHalf,                     // 上滚半页
            "<C-d>": DownHalf,                   // 下滚半页
            "g": Top,                            // 跳到顶部
            "G": Bottom,                         // 跳到底部
            
            // --- 选择和操作 ---
            "<CR>": Confirm,                     // 确认/回车
            "<Space>": Select,                   // 空格选中
            "<C-Space>": InvertSelection,        // 反选
            
            // --- 内容操作 ---
            "a": Add,                            // 添加到播放队列
            "A": AddAll,                         // 添加全部
            "d": Delete,                         // 删除
            "D": Delete,                         // 删除（同上）
            "r": Rename,                         // 重命名
            
            // --- 输入和搜索 ---
            "i": FocusInput,                     // 聚焦输入框
            "/": EnterSearch,                    // 进入搜索模式
            "n": NextResult,                     // 下一个搜索结果
            "N": PreviousResult,                 // 上一个搜索结果
            
            // --- 列表操作 ---
            "J": MoveDown,                       // 向下移动项目
            "K": MoveUp,                         // 向上移动项目
            "B": ShowInfo,                       // 显示详细信息
            
            // --- 退出操作 ---
            "<C-c>": Close,                      // Ctrl+C关闭
            "<Esc>": Close,                      // ESC关闭
            "<C-z>": ContextMenu(),              // 上下文菜单
        },
        
        // ===== 播放队列专用键位 =====
        queue: {
            "<CR>": Play,                        // 播放选中歌曲
            "d": Delete,                         // 删除选中歌曲
            "D": DeleteAll,                      // 清空播放队列
            "a": AddToPlaylist,                  // 添加到播放列表
            "C": JumpToCurrent,                  // 跳转到当前播放歌曲
            "X": Shuffle,                        // 随机排列队列
            "<C-s>": Save,                       // 保存播放队列为播放列表
        },
    ),
    
    // ==================== 界面布局配置 ====================
    tabs: [
        // 主界面：播放队列 + 专辑封面（黄金比例分割）
        (
            name: "Queue",
            pane: Split(
                direction: Horizontal,           // 水平分割
                panes: [
                    (size: "35%", pane: Pane(AlbumArt)),  // 左侧35%显示专辑封面
                    (size: "65%", pane: Pane(Queue)),     // 右侧65%显示播放队列
                ],
            ),
        ),
        // 目录浏览界面
        (
            name: "Directories",
            pane: Pane(Directories),
        ),
        // 艺术家浏览界面
        (
            name: "Artists",
            pane: Pane(Artists),
        ),
        // 专辑艺术家浏览界面
        (
            name: "Album Artists",
            pane: Pane(AlbumArtists),
        ),
        // 专辑浏览界面
        (
            name: "Albums",
            pane: Pane(Albums),
        ),
        // 播放列表管理界面
        (
            name: "Playlists",
            pane: Pane(Playlists),
        ),
        // 搜索界面
        (
            name: "Search",
            pane: Pane(Search),
        ),
    ],
)
